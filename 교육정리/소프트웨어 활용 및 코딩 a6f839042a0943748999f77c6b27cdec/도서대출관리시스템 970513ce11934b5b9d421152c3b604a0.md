# 도서대출관리시스템

무작정 만들었던…

최상위 클래스 - Library

- 도서관을 열고 닫고

```java
public interface Library {
    public boolean open();
    public void close();
}
```

Book 클래스

```java
package kr.ac.kopo.Library;

public interface Book extends Library{
    public void borrow();
    public void returnBook();
    public void bookSearch();
    public void printBookList();
    public void bookInfoChange();
    public void bookAdd();
    public void bookDelete();
}
```

Loan 클래스

```java
package kr.ac.kopo.Library;

import java.io.BufferedReader;
import java.io.BufferedWriter;
import java.io.File;
import java.io.FileReader;
import java.io.FileWriter;
import java.io.InputStreamReader;
import java.sql.Date;
import java.text.DecimalFormat;
import java.text.SimpleDateFormat;
import java.util.Calendar;
import java.util.HashMap;
import java.util.Map;
import java.util.Scanner;

public class Loan {
    BookData b = new BookData();
    MemberData m = new MemberData();
    Scanner sc = new Scanner(System.in);
    BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
    Map<String, BookData> map = new HashMap<>();
    DecimalFormat df = new DecimalFormat("000");
    private Calendar now = Calendar.getInstance();
    public void borrow() { 
        System.out.println("1.도서대출 2.도서대출목록");
        int num = sc.nextInt();
        sc.nextLine();
       
        switch(num) {
            case 1:
                try {
                    System.out.println("대출하기 원하는 코드번호: ");
                    String code = br.readLine();
                    BookData db = map.get(code);

                    if (map.get(code) == null) {
                        System.out.println("없어요~");
                    }

                    if (db.isRental() && db.getStock() == 0) {
                        System.out.println("이미 대여중입니다.");
                        return;
                    }

                    System.out.println("몇 권 빌리시나요?");
                    int bookNum = sc.nextInt();
                    sc.nextLine();

                    if (bookNum > db.getStock()) {
                        System.out.println("재고보다 많이 빌릴 수 없습니다.");
                        System.out.println("다시 시도해주세요...");
                        borrow();
                    } else {
                        db.setStock(db.getStock() - bookNum);
                        System.out.println("번호\t책제목\t저자명\t재고");
                        System.out.println("========================================================================");
                        System.out.print(code + "\t");
                        System.out.print(db.getName() + "\t");
                        System.out.print(db.getAuthor() + "\t");
                        System.out.print(db.getStock() + "\n");
                        System.out.println("대여완료!");

                        Calendar now = Calendar.getInstance();
                        int lastday = now.getActualMaximum(Calendar.DAY_OF_MONTH);

                        // 대여시간 포맷팅
                        String rentalPattern = "yyyy년 M월 d일";
                        SimpleDateFormat rentalSdf = new SimpleDateFormat(rentalPattern);
                        String rentalDate = rentalSdf.format(now.getTime());
                        String returnDate;
                        System.out.println("대여시간 : " + rentalDate);

                        // 반납시간 계산 및 포맷팅
                        now.add(Calendar.DAY_OF_MONTH, 14);
                        if(now.get(Calendar.DAY_OF_MONTH) <= lastday) {
                            String returnPattern = "yyyy년 M월 d일";
                            SimpleDateFormat returnSdf = new SimpleDateFormat(returnPattern);
                            returnDate = returnSdf.format(now.getTime());
                            System.out.println("반납시간 : " + returnDate);
                        } else {
                            now.add(Calendar.MONTH, 1);
                            now.set(Calendar.DAY_OF_MONTH, now.get(Calendar.DAY_OF_MONTH) - lastday);
                            String returnPattern = "yyyy년 M월 d일";
                            SimpleDateFormat returnSdf = new SimpleDateFormat(returnPattern);
                            returnDate = returnSdf.format(now.getTime());
                            System.out.println("반납시간 : " + returnDate);
                        }

                        // 파일 입출력 기능 추가
                        String fileName = "Book.csv";
                        File file = new File(fileName);
                        FileWriter fw = new FileWriter(file);
                        BufferedWriter bw = new BufferedWriter(fw);

                        for (String key : map.keySet()) {
                            BookData book = map.get(key);
                            String line = book.getId() + "," + book.getName() + "," + book.getAuthor() + "," + book.getStock() + "," + book.isRental();
                            if (key.equals(code)) {
                                line += "," + rentalDate + "," + returnDate; // 대여 날짜와 반납 날짜 추가
                            }
                            bw.write(line);
                            bw.newLine();
                        }

                        bw.flush();
                        bw.close();
                        fw.close();
                    }
                } catch (Exception e) {
                    System.out.println(e.toString());
                }
                break;
        case 2 :
            try {
                BufferedReader br = new BufferedReader(new FileReader("Book.csv"));
                String line = "";
                System.out.println("번호\t책제목\t저자명\t재고\t대여상태\t빌린날짜\t\t\t반납예정날짜");
                System.out.println("======================================================");
                while ((line = br.readLine()) != null) {
                    String[] data = line.split(",");
                    String code = data[0];
                    String name = data[1];
                    String author = data[2];
                    int stock = Integer.parseInt(data[3]);
                    boolean rental = Boolean.parseBoolean(data[4]);
                    String rentalDate = data[5];
                    String returnDate = data[6];
                    System.out.print(code + "   ");
                    System.out.print(name + "   ");
                    System.out.print(author + "   ");
                    System.out.print(stock + "   ");
                    System.out.print(rental + " ");
                    System.out.print(rentalDate + "  ");
                    System.out.println(returnDate);
                }
                br.close();
            } catch (Exception e) {
                System.out.println(e.toString());
            }
            break;
        case 3:
            try {
                System.out.println("연장 원하는 코드번호 : ");
                String code = br.readLine();
                BookData db = map.get(code);
                
                if(db.isRental()==false) {
                    System.out.println("대출중이 아닙니다.");
                    return;
                }
                
                System.out.println("번호\t책제목\t책장르\t저자명\t재고");
                System.out.println("===================================");
                System.out.print(code + "\t");
                System.out.print(db.getName() + "\t");
                System.out.print(db.getAuthor() + "\t");
                System.out.print(db.getStock() + "\n");
                
                System.out.print("입력하신 정보가 맞나요?(y/n) : ");
                String ans = sc.nextLine();
                if(ans.equals("y")||ans.equals("Y")) {
                    String pattern = "yyyy년 M월 d일";
                    SimpleDateFormat sdf = new SimpleDateFormat(pattern);
                    String data = sdf.format(new Date(num));
                    System.out.println("대여시간 : " + data);
                    int lastday = now.getActualMaximum(Calendar.DAY_OF_MONTH);
                    if(now.get(Calendar.DAY_OF_MONTH)+7 <= lastday) {
                        System.out.println("연장 후 반납시간 : " + now.get(Calendar.YEAR) + "년 " + (now.get(Calendar.MONTH)+1) + "월 " + (now.get(Calendar.DAY_OF_MONTH)+7) + "일");
                    } else {
                        System.out.println("연장 후 반납시간 : " + now.get(Calendar.YEAR) + "년 " + (now.get(Calendar.MONTH)+2) + "월 " + (now.get(Calendar.DAY_OF_MONTH)+7-lastday) + "일");
                    }
                } else if(ans.equals("n")||ans.equals("N")) {
                    System.out.println("취소되었습니다.");
                } else {
                    System.out.println("y 또는 n만 입력해주세요.");
                    System.out.println("다시 시도해주세요.");
                    borrow();
                }
                
            } catch(Exception e) {
                System.out.println(e.toString());
            }
            break;
        default :
            return;
        }
    }

}
```

Member

```java
public interface Member extends Library{
   public void join();
   public void logIn();
   public void logOut();
   public void userSearch();
   public void userPrint();
   public void userUpdate();
   public void userDelete();
}
```

BookData

```java
package kr.ac.kopo.Library;

public class BookData {
    private String id;
    private String name;
    private String author;
    private boolean rental;
    private int stock;
    public BookData() {
        
    }
    public BookData(String id, String name, String author, boolean rental, int stock) {
        super();
        this.id = id;
        this.name = name;
        this.author = author;
        this.rental = rental;
        this.stock = stock;
    }
    public String getId() {
        return id;
    }
    public void setId(String id) {
        this.id = id;
    }
    public String getName() {
        return name;
    }
    public void setName(String name) {
        this.name = name;
    }
    public String getAuthor() {
        return author;
    }
    public void setAuthor(String author) {
        this.author = author;
    }
    public boolean isRental() {
        return rental;
    }
    public void setRental(boolean rental) {
        this.rental = rental;
    }
    public int getStock() {
        return stock;
    }
    public void setStock(int stock) {
        this.stock = stock;
    }

}
```

BookInfo

```java
package kr.ac.kopo.Library;

import java.io.BufferedReader;
import java.io.BufferedWriter;
import java.io.File;
import java.io.FileNotFoundException;
import java.io.FileReader;
import java.io.FileWriter;
import java.io.IOException;
import java.io.InputStreamReader;
import java.sql.Date;
import java.text.DecimalFormat;
import java.text.SimpleDateFormat;
import java.util.Calendar;
import java.util.HashMap;
import java.util.Map;
import java.util.Scanner;
import java.util.StringTokenizer;
import javax.swing.text.html.HTMLDocument.Iterator;

public class BookInfo implements Book{
    Scanner sc = new Scanner(System.in);
    BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
    Map<String, BookData> map = new HashMap<>();
    DecimalFormat df = new DecimalFormat("000");
    private Calendar now = Calendar.getInstance();
    
    //도서대출관련
    public void borrow() { 
        System.out.println("1.도서대출 2.도서대출목록");
        int num = sc.nextInt();
        sc.nextLine();
       
        switch(num) {
            case 1:
                try {
                    System.out.println("대출하기 원하는 코드번호: ");
                    String code = br.readLine();
                    BookData db = map.get(code);

                    if (map.get(code) == null) {
                        System.out.println("없어요~");
                    }

                    if (db.isRental() && db.getStock() == 0) {
                        System.out.println("이미 대여중입니다.");
                        return;
                    }

                    System.out.println("몇 권 빌리시나요?");
                    int bookNum = sc.nextInt();
                    sc.nextLine();

                    if (bookNum > db.getStock()) {
                        System.out.println("재고보다 많이 빌릴 수 없습니다.");
                        System.out.println("다시 시도해주세요...");
                        borrow();
                    } else {
                        db.setStock(db.getStock() - bookNum);
                        System.out.println("번호\t책제목\t저자명\t재고");
                        System.out.println("========================================================================");
                        System.out.print(code + "\t");
                        System.out.print(db.getName() + "\t");
                        System.out.print(db.getAuthor() + "\t");
                        System.out.print(db.getStock() + "\n");
                        System.out.println("대여완료!");

                        Calendar now = Calendar.getInstance();
                        int lastday = now.getActualMaximum(Calendar.DAY_OF_MONTH);

                        // 대여시간 포맷팅
                        String rentalPattern = "yyyy년 M월 d일";
                        SimpleDateFormat rentalSdf = new SimpleDateFormat(rentalPattern);
                        String rentalDate = rentalSdf.format(now.getTime());
                        String returnDate;
                        System.out.println("대여시간 : " + rentalDate);

                        // 반납시간 계산 및 포맷팅
                        now.add(Calendar.DAY_OF_MONTH, 14);
                        if(now.get(Calendar.DAY_OF_MONTH) <= lastday) {
                            String returnPattern = "yyyy년 M월 d일";
                            SimpleDateFormat returnSdf = new SimpleDateFormat(returnPattern);
                            returnDate = returnSdf.format(now.getTime());
                            System.out.println("반납시간 : " + returnDate);
                        } else {
                            now.add(Calendar.MONTH, 1);
                            now.set(Calendar.DAY_OF_MONTH, now.get(Calendar.DAY_OF_MONTH) - lastday);
                            String returnPattern = "yyyy년 M월 d일";
                            SimpleDateFormat returnSdf = new SimpleDateFormat(returnPattern);
                            returnDate = returnSdf.format(now.getTime());
                            System.out.println("반납시간 : " + returnDate);
                        }

                        // 파일 입출력 기능 추가
                        String fileName = "Book.csv";
                        File file = new File(fileName);
                        FileWriter fw = new FileWriter(file);
                        BufferedWriter bw = new BufferedWriter(fw);

                        for (String key : map.keySet()) {
                            BookData book = map.get(key);
                            String line = book.getId() + "," + book.getName() + "," + book.getAuthor() + "," + book.getStock() + "," + book.isRental();
                            if (key.equals(code)) {
                                line += "," + rentalDate + "," + returnDate; // 대여 날짜와 반납 날짜 추가
                            }
                            bw.write(line);
                            bw.newLine();
                        }

                        bw.flush();
                        bw.close();
                        fw.close();
                    }
                } catch (Exception e) {
                    System.out.println(e.toString());
                }
                break;
        case 2 :
            try {
                BufferedReader br = new BufferedReader(new FileReader("Book.csv"));
                String line = "";
                System.out.println("번호\t책제목\t저자명\t재고\t대여상태\t빌린날짜\t\t\t반납예정날짜");
                System.out.println("======================================================");
                while ((line = br.readLine()) != null) {
                    String[] data = line.split(",");
                    String code = data[0];
                    String name = data[1];
                    String author = data[2];
                    int stock = Integer.parseInt(data[3]);
                    boolean rental = Boolean.parseBoolean(data[4]);
                    String rentalDate = data[5];
                    String returnDate = data[6];
                    System.out.print(code + "   ");
                    System.out.print(name + "   ");
                    System.out.print(author + "   ");
                    System.out.print(stock + "   ");
                    System.out.print(rental + " ");
                    System.out.print(rentalDate + "  ");
                    System.out.println(returnDate);
                }
                br.close();
            } catch (Exception e) {
                System.out.println(e.toString());
            }
            break;
        case 3:
            try {
                System.out.println("연장 원하는 코드번호 : ");
                String code = br.readLine();
                BookData db = map.get(code);
                
                if(db.isRental()==false) {
                    System.out.println("대출중이 아닙니다.");
                    return;
                }
                
                System.out.println("번호\t책제목\t책장르\t저자명\t재고");
                System.out.println("===================================");
                System.out.print(code + "\t");
                System.out.print(db.getName() + "\t");
                System.out.print(db.getAuthor() + "\t");
                System.out.print(db.getStock() + "\n");
                
                System.out.print("입력하신 정보가 맞나요?(y/n) : ");
                String ans = sc.nextLine();
                if(ans.equals("y")||ans.equals("Y")) {
                    String pattern = "yyyy년 M월 d일";
                    SimpleDateFormat sdf = new SimpleDateFormat(pattern);
                    String data = sdf.format(new Date(num));
                    System.out.println("대여시간 : " + data);
                    int lastday = now.getActualMaximum(Calendar.DAY_OF_MONTH);
                    if(now.get(Calendar.DAY_OF_MONTH)+7 <= lastday) {
                        System.out.println("연장 후 반납시간 : " + now.get(Calendar.YEAR) + "년 " + (now.get(Calendar.MONTH)+1) + "월 " + (now.get(Calendar.DAY_OF_MONTH)+7) + "일");
                    } else {
                        System.out.println("연장 후 반납시간 : " + now.get(Calendar.YEAR) + "년 " + (now.get(Calendar.MONTH)+2) + "월 " + (now.get(Calendar.DAY_OF_MONTH)+7-lastday) + "일");
                    }
                } else if(ans.equals("n")||ans.equals("N")) {
                    System.out.println("취소되었습니다.");
                } else {
                    System.out.println("y 또는 n만 입력해주세요.");
                    System.out.println("다시 시도해주세요.");
                    borrow();
                }
                
            } catch(Exception e) {
                System.out.println(e.toString());
            }
            break;
        default :
            return;
        }
    }
    // 모든 책 프린트
    public void printBookList() {
        try {
            BufferedReader reader = new BufferedReader(new FileReader("Book.csv"));
            String line;
            System.out.println("코드번호\t책제목\t저자명\t재고");
            System.out.println("=====================================");
            while ((line = reader.readLine()) != null) {
                String[] data = line.split(",");
                System.out.println(data[0] + "\t" + data[1] + "\t" + data[2] + "\t" + data[3]);
            }
            reader.close();
        } catch (Exception e) {
            System.out.println(e.toString());
        }
    }
    // 책 등록
    public void bookAdd() {
        System.out.println("\n<책 등록>");
        try {
            String code;
            BookData db = new BookData();

            System.out.print("코드입력 : ");
            code = br.readLine();
            if (map.containsKey(code)) {
                System.out.println("등록된 책 입니다.\n");
                return;
            }
            System.out.print("책 이름 : ");
            db.setName(br.readLine());

            System.out.print("책 저자 : ");
            db.setAuthor(br.readLine());

            System.out.print("재고 수 : ");
            db.setStock(sc.nextInt());
            sc.nextLine();

            System.out.println("코드번호\t책제목\t저자명\t재고");
            System.out.println("==============================");
            System.out.println(code + "\t" + db.getName() + "\t" + db.getAuthor() + "\t" + db.getStock());

            System.out.print("입력하신 정보가 맞나요?(y/n) : ");
            String ans = sc.nextLine();
            if (ans.equalsIgnoreCase("y")) {
                map.put(code, db);
                BufferedWriter writer = new BufferedWriter(new FileWriter("Book.csv", true));
                writer.write(code + "," + db.getName() + "," + db.getAuthor() + "," + db.getStock());
                writer.newLine();
                writer.close();

                System.out.println("책이 정상적으로 등록되었습니다.");
            } else if (ans.equalsIgnoreCase("n")) {
                System.out.println("취소되었습니다.");
            } else {
                System.out.println("y 또는 n만 입력해주세요.");
                System.out.println("책 정보를 다시 입력해주세요.");
                bookAdd();
            }

        } catch (Exception e) {
            System.out.println(e.toString());
        }
    }
    
    //책 삭제
    public void bookDelete() {
        System.out.println("\n<책 삭제>");

        try {
            System.out.print("삭제할 책의 코드를 입력하세요 : ");
            String code = br.readLine();
            if (map.containsKey(code)) {
                BookData db = map.get(code);

                System.out.println("삭제할 책 정보");
                System.out.println("코드번호\t책제목\t저자명\t재고");
                System.out.println("========================================================================");
                System.out.println(code + "\t" + db.getName() + "\t" + db.getAuthor() + "\t" + db.getStock());

                System.out.print("정말 삭제하시겠습니까?(y/n) : ");
                String ans = sc.nextLine();
                if (ans.equalsIgnoreCase("y")) {
                    map.remove(code);

                    File file = new File("Book.csv");
                    File temp = File.createTempFile("Book", ".csv");
                    BufferedReader reader = new BufferedReader(new FileReader(file));
                    BufferedWriter writer = new BufferedWriter(new FileWriter(temp));

                    String lineToRemove = code + "," + db.getName() + "," + db.getAuthor() + "," + db.getStock();
                    String currentLine;

                    while ((currentLine = reader.readLine()) != null) {
                        String trimmedLine = currentLine.trim();
                        if (trimmedLine.equals(lineToRemove)) continue;
                        writer.write(currentLine + System.getProperty("line.separator"));
                    }
                    writer.close();
                    reader.close();

                    if (file.delete()) {
                        temp.renameTo(file);
                        System.out.println("책이 정상적으로 삭제되었습니다.");
                    }
                } else if (ans.equalsIgnoreCase("n")) {
                    System.out.println("취소되었습니다.");
                } else {
                    System.out.println("y 또는 n만 입력해주세요.");
                    System.out.println("책 정보를 다시 입력해주세요.");
                    bookDelete();
                }
            } else {
                System.out.println("해당 코드의 책이 존재하지 않습니다.");
            }
        } catch (Exception e) {
            
        }
    }
    public void readBookData() throws IOException {
        BufferedReader reader = new BufferedReader(new FileReader("Book.csv"));
        String line;
        while ((line = reader.readLine()) != null) {
            String[] fields = line.split(",");
            BookData book = new BookData();
            book.setId(fields[0]);
            book.setName(fields[1]);
            book.setAuthor(fields[2]);
            book.setStock(Integer.parseInt(fields[3]));
            book.setRental(false);

            map.put(book.getId(), book);
        }
        reader.close();
    }
    //반납
    @Override
    public void returnBook() {
        // TODO Auto-generated method stub
        
    }
    // 책 검색
    @Override
    public void bookSearch() {
        // TODO Auto-generated method stub
        
    }
    // 책 수정
    @Override
    public void bookInfoChange() {
        // TODO Auto-generated method stub
        
    }
    
    // 열기
    @Override
    public boolean open() {
        // TODO Auto-generated method stub
        return false;
    }
    // 닫기
    @Override
    public void close() {
        // TODO Auto-generated method stub
        
    }
}
```

MemberData

```java
package kr.ac.kopo.Library;

public class MemberData  {
    private String id;
    private String name;
    private String address;
    private String phone;
    private String publishedDate;
    public MemberData() {}
    public MemberData(String id, String name, String address, String phone) {
        this.id = id;
        this.name = name;
        this.phone = phone;
        this.address = address;

    }
    public MemberData(String id, String name, String address, String phone, String publishedDate) {
        this.id = id;
        this.name = name;
        this.phone = phone;
        this.publishedDate = publishedDate;
        this.address = address;

    }
    public String getId() {
        return id;
    }
    public void setId(String id) {
        this.id = id;
    }
    public String getName() {
        return name;
    }
    public void setName(String name) {
        this.name = name;
    }
    public String getAddress() {
        return address;
    }
    public void setAddress(String address) {
        this.address = address;
    }
    public String getPhone() {
        return phone;
    }
    public void setPhone(String phone) {
        this.phone = phone;
    }
    public String getPublishedDate() {
        return publishedDate;
    }
    public void setPublishedDate(String publishedDate) {
        this.publishedDate = publishedDate;
    }
}
```

LoanData

```java
package kr.ac.kopo.Library;

public class LoanData {
    private String id;
    private String name;
    private String author;
    private boolean rental;
    private int stock;
    BookData book = new BookData();
    MemberData memeber = new MemberData();
    
    
    public String getId() {
        return id;
    }
    public void setId(String id) {
        this.id = id;
    }
    public String getName() {
        return name;
    }
    public void setName(String name) {
        this.name = name;
    }
    public String getAuthor() {
        return author;
    }
    public void setAuthor(String author) {
        this.author = author;
    }
    public boolean isRental() {
        return rental;
    }
    public void setRental(boolean rental) {
        this.rental = rental;
    }
    public int getStock() {
        return stock;
    }
    public void setStock(int stock) {
        this.stock = stock;
    }
    public BookData getBook() {
        return book;
    }
    public void setBook(BookData book) {
        this.book = book;
    }
    public MemberData getMemeber() {
        return memeber;
    }
    public void setMemeber(MemberData memeber) {
        this.memeber = memeber;
    }
}
```

MemberInfo

```java
package kr.ac.kopo.Library;

import java.io.BufferedReader;
import java.io.BufferedWriter;
import java.io.File;
import java.io.FileReader;
import java.io.FileWriter;
import java.io.IOException;
import java.io.InputStreamReader;
import java.io.PrintWriter;
import java.util.ArrayList;
import java.util.List;
import java.util.Scanner;

public class MemberInfo implements Member {
    BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
    Scanner sc = new Scanner(System.in);
    private List<MemberData>list = new ArrayList<MemberData>();
    private MemberData userdb;
    String MemberScv = "Member";
    MemberData db = new MemberData();
    String filename = "Members.csv";
    
    //생성자
    public MemberInfo() {
        MemberData db = new MemberData();
        db.setId("123");
        db.setName("관리자(김관중)");
        db.setAddress("경기도 부천시 범박동");
        db.setPhone("010-9217-5176");
        db.setPublishedDate("1998-08-15");
        list.add(db);
    }
    // 로그인
    public void logIn() {
        System.out.println("로그인");
        String id;
        
        try {
            System.out.print("로그인 할 ID를 입력하요. : ");
            id=br.readLine();
            
            MemberData db = readUser(id);
            if(db == null) {
                System.out.println("그런 ID는 존재하지 않아요");
                return;
            } else {
                userdb = db;
                System.out.println("로그인이 되었습니다.");
                return;
            }
        } catch(Exception e) {
            System.out.println(e.toString());
        }
        
    }
    // 회원등록
    public void join() {
        System.out.println("회원등록");
        try {
            System.out.print("아이디를 입력해주세요. : ");
            db.setId(br.readLine());
            
            if(readUser(db.getId()) != null) {
                System.out.println("이미 등록된 아이디 입니다.");
                return;
            } else {
                System.out.println("사용가능한 아이디 입니다.");
            }
            System.out.print("이름을 입력해주세요. : ");
            db.setName(br.readLine());
            System.out.print("주소를 입력하세요. : ");
            db.setAddress(br.readLine());
            System.out.print("생년월일을 입력하세요 : ");
            db.setPublishedDate(br.readLine());
            System.out.print("전화번호를 입력해주세요. (010-9217-5176) : ");
            db.setPhone(br.readLine());
            String[] phoneNum = db.getPhone().split("-");
            String Num1 = phoneNum[0];
            String Num2 = phoneNum[1];
            String Num3 = phoneNum[2];
            if(!(Num1.equals("010"))) {
                System.out.println("핸드폰 번호는 010으로 시작합니다.");
                return;
            }
            if(!(Num2.length() == 4 && Num3.length() == 4)) {
                System.out.println("핸드폰 번호를 잘못 입력하셨습니다.");
                return;
            }
                
            System.out.println("이름\t생년월일\tID\t핸드폰번호");
            System.out.println(db.getName() + "\t" + db.getAddress() + "\t" + db.getId() + "\t" + db.getPhone()); 
            System.out.print("입력하신 정보가 맞나요?(y/n) : ");
            String ans = sc.nextLine();
            
            if(ans.equals("y")||ans.equals("Y")) {
                list.add(db);               
                FileWriter fw = new FileWriter(filename, true);
                PrintWriter pw = new PrintWriter(fw);
                pw.println(db.getName() + "," + db.getAddress() + "," + db.getId() + "," + db.getPhone());
                pw.close();

                // 회원 가입 축하 메시지 출력
                System.out.println("회원가입을 축하합니다.");
                } else if(ans.equals("n")||ans.equals("N")) {
                    System.out.println("회원가입이 취소되었습니다.");
                    } else {
                        System.out.println("y또는n만 입력해주세요.");
                        System.out.println("회원정보를 다시 입력해주세요.");
                        join();
                    }
        }catch(Exception e) {
           
        }
 
    }
    //회원 삭제
    public void userDelete() {
        System.out.println("회원 삭제");
        try {
            System.out.print("삭제할 회원의 아이디를 입력해주세요. : ");
            String deleteId = br.readLine();

            boolean isExist = false;
            for (int i = 0; i < list.size(); i++) {
                if (list.get(i).getId().equals(deleteId)) {
                    isExist = true;
                    list.remove(i);
                    break;
                }
            }

            if (!isExist) {
                System.out.println("삭제할 회원이 존재하지 않습니다.");
                return;
            }

            BufferedReader reader = new BufferedReader(new FileReader(filename));
            StringBuilder sb = new StringBuilder();
            String line;
            while ((line = reader.readLine()) != null) {
                String[] fields = line.split(",");
                if (!fields[0].equals(deleteId)) {  
                    sb.append(line).append("\n");
                }
            }
            reader.close();

            BufferedWriter writer = new BufferedWriter(new FileWriter(filename));
            writer.write(sb.toString());
            writer.close();

            System.out.println("회원 삭제가 완료되었습니다.");

        } catch (Exception e) {
            e.printStackTrace();
        }
    }
    //회원 수정
    @Override
    public void userUpdate() {
        // TODO Auto-generated method stub
        
    }
    

    // 회원조회
    private MemberData readUser(String id) {
        MemberData db = null;
        for(MemberData data : list) {
            if(data.getId().equals(id)) {
                db = data;
                break;
            }
        }
        return db;
    }
    //회원 전체 출력
    public void userPrint() {
        String line = "";
        String csvsplitBy = ",";
        try (BufferedReader br = new BufferedReader(new FileReader(filename))) {
            while ((line = br.readLine()) != null) {
                // CSV 파일의 각 라인을 그대로 출력
                System.out.println(line);
            }

        } catch (IOException e) {
            e.printStackTrace();
        }
    }
    
    //로그아웃
    @Override
    public void logOut() {
        // TODO Auto-generated method stub
        
    }
    //회원 검색
    @Override
    public void userSearch() {
        // TODO Auto-generated method stub
        
    }
    // MemberData 정보 읽어오기
    public ArrayList<String[]> readCsv(String fileName) {
        ArrayList<String[]> values = new ArrayList<>();
        try {
            File file = new File(fileName);
            FileReader fr = new FileReader(file);
            BufferedReader br = new BufferedReader(fr);
            String line = "";
            while ((line = br.readLine()) != null) {
                String[] fields = line.split(",");
                values.add(fields);
            }
            br.close();
            fr.close();
        } catch (IOException e) {
            e.printStackTrace();
        }
        return values;
    }
    
    public ArrayList<MemberData> readCSV() {
        ArrayList<MemberData> members = new ArrayList<>();
        try (BufferedReader br = new BufferedReader(new FileReader("Members.csv"))) {
            String line;
            while ((line = br.readLine()) != null) {
                String[] values = line.split(",");
                String id = values[0];
                String name = values[1];
                String address = values[2];
                String phone = values[3];
                members.add(new MemberData(id, name, address, phone));
            }
        } catch (IOException e) {
            e.printStackTrace();
        }
        return members;
    }
    
    //쓰기
    public void writeCSV(List<MemberData> members) {
        try (PrintWriter writer = new PrintWriter(new FileWriter("Members.csv"))) {
            for (MemberData member : members) {
                writer.println(member.getId() + "," + member.getName() + "," + member.getPhone());
            }
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
    
    //  열기
    @Override
    public boolean open() {
        // TODO Auto-generated method stub
        return false;
    }
    //  닫기
    @Override
    public void close() {
        // TODO Auto-generated method stub
        
    }
}
```

Main

```java
package kr.ac.kopo.Library;

import java.io.IOException;
import java.util.Scanner;

public class LibraryMain {
    public static void main(String[] args) throws IOException {
        Scanner sc = new Scanner(System.in);
        MemberInfo user = new MemberInfo();
        BookInfo book = new BookInfo();
        Loan info = new Loan();
        int num;
        while(true) {
            do {
                System.out.println("1.회원관리 2.도서관리 3.종료");
                num = sc.nextInt();
                sc.nextLine();
            }while(num < 1 || num > 3);
            if(num == 3) {
                System.out.println("종료할게요");
                break;
            }
            
            switch(num) {
                // 1.회원관리
                case 1:
                    System.out.println("0.로그인 1.회원등록 2.회원수정 3.회원삭제 4.회원전체조회 ");
                    num = sc.nextInt();
                    switch(num) {
                        case 0:
                            // 로그인
                            user.logIn();
                            break;
                        case 1:
                            // 회원등록
                            user.join();
                            break;
                        case 2:
                            // 회원수정
                            //user.userUpdate();
                            break;
                            
                        case 3:
                            // 회원삭제
                            user.userDelete();
                            break;
                        case 4:
                            // 회원전체조회
                            user.userPrint();
                            break;                   
                    }
                    break;
                    
                case 2:
                    // 2.도서관리
                    do {
                        System.out.println("1.도서 대출 관련 2.도서추가 3.도서삭제 4.모든 도서 출력");
                        num = sc.nextInt();
                        sc.nextLine();
                    }while(num < 1 || num > 7);                   
                    switch(num){
                        case 1:
                            // 도서 대출 관련 --> 1.도서 대출 2.도서 전체 출력 3.
                            info.borrow();
                            break;
                        case 2:
                            // 도서 추가
                            book.bookAdd();
                            break;
                        case 3:
                            // 도서 삭제
                            book.bookDelete();
                            break;
                        case 4:
                            //도서 모두 출력
                            book.printBookList();
                        default:
                            break;
                    }
                    
                    
                    
            }
        }
        
    }

}
```

로그인

![Untitled](%E1%84%83%E1%85%A9%E1%84%89%E1%85%A5%E1%84%83%E1%85%A2%E1%84%8E%E1%85%AE%E1%86%AF%E1%84%80%E1%85%AA%E1%86%AB%E1%84%85%E1%85%B5%E1%84%89%E1%85%B5%E1%84%89%E1%85%B3%E1%84%90%E1%85%A6%E1%86%B7%20970513ce11934b5b9d421152c3b604a0/Untitled.png)

![Untitled](%E1%84%83%E1%85%A9%E1%84%89%E1%85%A5%E1%84%83%E1%85%A2%E1%84%8E%E1%85%AE%E1%86%AF%E1%84%80%E1%85%AA%E1%86%AB%E1%84%85%E1%85%B5%E1%84%89%E1%85%B5%E1%84%89%E1%85%B3%E1%84%90%E1%85%A6%E1%86%B7%20970513ce11934b5b9d421152c3b604a0/Untitled%201.png)

회원등록,  회원전체조

![Untitled](%E1%84%83%E1%85%A9%E1%84%89%E1%85%A5%E1%84%83%E1%85%A2%E1%84%8E%E1%85%AE%E1%86%AF%E1%84%80%E1%85%AA%E1%86%AB%E1%84%85%E1%85%B5%E1%84%89%E1%85%B5%E1%84%89%E1%85%B3%E1%84%90%E1%85%A6%E1%86%B7%20970513ce11934b5b9d421152c3b604a0/Untitled%202.png)

회원삭제

![Untitled](%E1%84%83%E1%85%A9%E1%84%89%E1%85%A5%E1%84%83%E1%85%A2%E1%84%8E%E1%85%AE%E1%86%AF%E1%84%80%E1%85%AA%E1%86%AB%E1%84%85%E1%85%B5%E1%84%89%E1%85%B5%E1%84%89%E1%85%B3%E1%84%90%E1%85%A6%E1%86%B7%20970513ce11934b5b9d421152c3b604a0/Untitled%203.png)

도서 추가

![Untitled](%E1%84%83%E1%85%A9%E1%84%89%E1%85%A5%E1%84%83%E1%85%A2%E1%84%8E%E1%85%AE%E1%86%AF%E1%84%80%E1%85%AA%E1%86%AB%E1%84%85%E1%85%B5%E1%84%89%E1%85%B5%E1%84%89%E1%85%B3%E1%84%90%E1%85%A6%E1%86%B7%20970513ce11934b5b9d421152c3b604a0/Untitled%204.png)

도서 삭제

![Untitled](%E1%84%83%E1%85%A9%E1%84%89%E1%85%A5%E1%84%83%E1%85%A2%E1%84%8E%E1%85%AE%E1%86%AF%E1%84%80%E1%85%AA%E1%86%AB%E1%84%85%E1%85%B5%E1%84%89%E1%85%B5%E1%84%89%E1%85%B3%E1%84%90%E1%85%A6%E1%86%B7%20970513ce11934b5b9d421152c3b604a0/Untitled%205.png)

다른건 에러..

설계를 잘하자..! 객체지향적으로..

—>하다보니 잘못됨을 느끼고 다시 설계 시작(잘못된 설계를 할 예정)

—>기능들을 먼저 인터페이스화 해서 그에 맞게 기능을 하위클래스에서 작성해야 했다. 

먼저 파일 입출력을 만드는중

아웃풋 인터페이스

```java
import java.util.ArrayList;
import java.util.HashMap;
import java.util.Map;

import kr.ac.kopo.library.Book;
import kr.ac.kopo.library.Member;
import kr.ac.kopo.library.User;

public interface LibraryOutputStream {
    public void writeManager(Map<String, String> managerList);
    public void writeMember(ArrayList<Member> MemberInfo);    
    public void writeMemberLoginInfo(Map<String, String> MemberList);     
    public void writeBook(ArrayList<Book> bookList);   
    public void currentUser(User user);
    public void writeRentalHistory(HashMap<String, Book> rentalBook);
}
```

아웃풋 

```java
package kr.ac.kopo.library.FileIO;

import java.io.FileNotFoundException;
import java.io.FileOutputStream;
import java.io.IOException;
import java.io.ObjectOutputStream;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.Map;

import kr.ac.kopo.library.Book;
import kr.ac.kopo.library.Member;
import kr.ac.kopo.library.User;

public class LibraryOutputStreamImpl implements LibraryOutputStream{
    FileOutputStream fos;
    ObjectOutputStream oos;
    @Override
    public void writeManager(Map<String, String> managerList){
        try {
            fos = new FileOutputStream("Manager.csv",true);
            oos = new ObjectOutputStream(fos);
            
            oos.writeObject(managerList);
            oos.flush();
        } catch (Exception e) {
            e.printStackTrace();
        } finally {
            try {
                oos.close();
                fos.close();
            } catch (IOException e) {
                e.printStackTrace();
            }
            
        }

    }
    @Override
    public void writeMember(ArrayList<Member> MemberInfo) {
        try {
            fos = new FileOutputStream("Member.csv");
            oos = new ObjectOutputStream(fos);

            oos.writeObject(MemberInfo);
            oos.flush();
            
        } catch (Exception e) {
            
        } finally {
            try {
                oos.close();
                fos.close();
            } catch (IOException e) {
                e.printStackTrace();
            }
        }
    }

    @Override
    public void writeMemberLoginInfo(Map<String, String> MemberList) {
        try {
            fos = new FileOutputStream("Login.csv");
            oos = new ObjectOutputStream(fos);
            Map<String, String> map = new HashMap<String, String>();
            
            for(String key : MemberList.keySet()) {
                map.put(key, MemberList.get(key));  
            }
            oos.writeObject(MemberList);
            oos.flush();
        } catch (Exception e) {
            e.printStackTrace();
        } finally {
            try {
                oos.close();
                fos.close();
            } catch (IOException e) {
                e.printStackTrace();
            }
            
        }
    }

    @Override
    public void writeBook(ArrayList<Book> bookList) {
        try {
            fos = new FileOutputStream("Book.csv");
            oos = new ObjectOutputStream(fos);
            oos.writeObject(bookList);
            oos.flush();
            
        } catch (Exception e) {
            
        } finally {
            try {
                oos.close();
                fos.close();
            } catch (IOException e) {
                e.printStackTrace();
            }
            
        }
    }

    @Override
    public void currentUser(User user) {
        try {
            fos = new FileOutputStream("User.csv");
            oos = new ObjectOutputStream(fos);
            oos.writeObject(user);
            oos.flush();
            
        } catch (Exception e) {
            
        } finally {
            try {
                oos.close();
                fos.close();
            } catch (IOException e) {
                e.printStackTrace();
            }
        }
    }

    @Override
    public void writeRentalHistory(HashMap<String, Book> rentalBook) {
        try {
            fos = new FileOutputStream("Rental.csv");
            oos = new ObjectOutputStream(fos);
            oos.writeObject(rentalBook);
            oos.flush();
        } catch (Exception e) {
            e.printStackTrace();
        } finally {
            try {
                oos.close();
                fos.close();
            } catch (IOException e) {
                e.printStackTrace();
            }
            
        }
    }
    

}
```

인풋 인터페이스

```java
package kr.ac.kopo.library.FileIO;

import java.util.HashMap;
import java.util.List;
import java.util.Map;

import kr.ac.kopo.library.Book;
import kr.ac.kopo.library.Member;
import kr.ac.kopo.library.User;

public interface LibraryInputStream {
    public HashMap<String, String> readManager();
    public HashMap<String, String> readMemberLoginInfo();
    public List<Member> readMember();
    public List<Book> readBook();
    public User readUser();
    public HashMap<String, Book> bookRental();
}
```

인풋

```java
package kr.ac.kopo.library.FileIO;

import java.io.EOFException;
import java.io.FileInputStream;
import java.io.FileNotFoundException;
import java.io.IOException;
import java.io.ObjectInputStream;
import java.io.Serializable;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.HashMap;
import java.util.List;
import java.util.Map;
import java.util.Set;

import kr.ac.kopo.library.Book;
import kr.ac.kopo.library.Member;
import kr.ac.kopo.library.User;

public class LibraryInputSteamImpl implements LibraryInputStream {
    FileInputStream fis;
    ObjectInputStream ois;

    public HashMap<String, String> readManager() {
        try {
            fis = new FileInputStream("Manager.csv");
            HashMap<String, String> managerList = new HashMap<>(); 
                            
            try {
                while(true) {
                    ois = new ObjectInputStream(fis);
                    @SuppressWarnings("unchecked")
                    HashMap<String, String> data = (HashMap<String, String>) ois.readObject();
                    Set<String> KeySet = data.keySet();
                    for(String key : KeySet) {
                        managerList.put(key, data.get(key));
                    }
                }
            } catch (EOFException e) {  // 파일에 더이상 읽어올 데이터가 없을 경우 에러 발생
                
            }
            return managerList;
        } catch (Exception e) {
            
        } finally {
            try {
                ois.close();
                fis.close();
            } catch (IOException e) {
                
            }
            
        }
        return null;

    }

    
    public HashMap<String, String> readMemberLoginInfo() {
        try {
            fis = new FileInputStream("Login.csv");
            HashMap<String, String> memberLoginInfo = new HashMap<>(); 
                            
            try {
                while(true) {
                    ois = new ObjectInputStream(fis);
                    @SuppressWarnings("unchecked")
                    HashMap<String, String> data = (HashMap<String, String>) ois.readObject();
                    Set<String> KeySet = data.keySet();
                    for(String key : KeySet) {
                        memberLoginInfo.put(key, data.get(key));
                    }
                }
            } catch (EOFException e) {  // 파일에 더이상 읽어올 데이터가 없을 경우 에러 발생
                
            }
            return memberLoginInfo;
        } catch (Exception e) {
            
        } finally {
            try {
                ois.close();
                fis.close();
            } catch (IOException e) {
                
            }
            
        }
        return null;

    }

    public List<Member> readMember() {
        try {
            fis = new FileInputStream("Member.csv");              
            ois = new ObjectInputStream(fis);           
            ArrayList<Member> member = (ArrayList<Member>) ois.readObject();
        
            return member;
        } catch (Exception e) {
            e.printStackTrace();
        } finally {
            try {
                ois.close();
                fis.close();
            } catch (IOException e) {
                
            }
            
        }
        return null;
    }

    public List<Book> readBook() {
        try {
            fis = new FileInputStream("Book.csv");                
            ois = new ObjectInputStream(fis);           
            ArrayList<Book> book = (ArrayList<Book>) ois.readObject();
        
            return book;
        } catch (Exception e) {
            e.printStackTrace();
        } finally {
            try {
                ois.close();
                fis.close();
            } catch (IOException e) {
                
            }
            
        }
        return null;
    
    }

    public User readUser() {
        try {
            fis = new FileInputStream("User.csv");                
            ois = new ObjectInputStream(fis);           
            User user = (User) ois.readObject();
        
            return user;
        } catch (Exception e) {
            e.printStackTrace();
        } finally {
            try {
                ois.close();
                fis.close();
            } catch (IOException e) {
                
            }
            
        }
        return null;
    }

    public HashMap<String, Book> bookRental() {
        try {
            fis = new FileInputStream("Rental.csv");
            HashMap<String, Book> bookRental = new HashMap<>(); 
                            
            try {
                while(true) {
                    ois = new ObjectInputStream(fis);
                    @SuppressWarnings("unchecked")
                    HashMap<String, Book> data = (HashMap<String, Book>) ois.readObject();
                    Set<String> KeySet = data.keySet();
                    for(String key : KeySet) {
                        bookRental.put(key, data.get(key));
                    }
                }
            } catch (EOFException e) {  // 파일에 더이상 읽어올 데이터가 없을 경우 에러 발생
                
            }
            return bookRental;
        } catch (Exception e) {
            
        } finally {
            try {
                ois.close();
                fis.close();
            } catch (IOException e) {
                
            }            
        }
        return null;
    }
    
}
```

BookInterface

```java
package kr.ac.kopo.library;

public interface BookInterface {
    public void addBook(int n);
    public void bookList();
    public void bookSearch(int searchType, String keyword);
    public void removeBook(String isbn);
    public void bookRental(String isbn);
    public void bookRentalExtend(String isbn);
    public void bookReturn(String isbn);
}
```

MemberInterface

```java
package kr.ac.kopo.library;

public interface MemberInterface {
    public void memberList();
    public void viewMemberInfo();
    public void modifyMemberInfo(int choice, String data);
    public void removeMember();
    public void rentalHistory();
}
```

User

```java
package kr.ac.kopo.library;

import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.Map;

public class User{
    
    private String id;
    private String password;
    private Map<String, Book> rentalBook = new HashMap();   // 회원의 도서 대여 내역 조회
    
    public User() {
        
    }
    
    public User(String id, String password) {
        this.id = id;
        this.password = password;
    }
    
    public String getId() {
        return id;
    }

    public String getPassword() {
        return password;
    }
    
    public Map<String, Book> getRentalBook() {
        return rentalBook;
    }

    public void addRentalHistory(String isbn, Book book) {
        rentalBook.put(isbn, book);
    }
    
    public void removeRentalHistory(String isbn) {
        rentalBook.remove(isbn);
    }

}
```

Member

```java
package kr.ac.kopo.library;

import java.io.Serializable;
import java.nio.channels.AsynchronousServerSocketChannel;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.Map;

import kr.ac.kopo.library.FileIO.LibraryInputSteamImpl;
import kr.ac.kopo.library.FileIO.LibraryOutputStreamImpl;

public class Member  {
    
    private String id;
    private String password;
    private String phoneNumber;
    private String address;
    private String name;
    public static User user;
    
    transient LibraryOutputStreamImpl libraryOutputStreamImpl = new LibraryOutputStreamImpl();
    transient LibraryInputSteamImpl libraryInputSteamImpl = new LibraryInputSteamImpl();

    private static Map<String, String> memberList = new HashMap<>();
    private static List<Member> memberInfo = new ArrayList<Member>();
    

    
    public Member() {
        
    }
    
    public Member(String id, String password, String name, String phoneNumber, String adderss) {
        this.id = id;
        this.password = password;
        this.name = name;
        this.phoneNumber = phoneNumber;
        this.address = adderss;
    }

    public String getId() {
        return id;
    }

    public String getPassword() {
        return password;
    }

    public void setPassword(String password) {
        this.password = password;
    }

    public String getPhoneNumber() {
        return phoneNumber;
    }
    
    public void setPhoneNumber(String phoneNumber) {
        this.phoneNumber = phoneNumber;
    }

    public String getAddress() {
        return address;
    }
    
    public void setAddress(String address) {
        this.address = address;
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    public static Map<String, String> getMemberList() {
        return memberList;
    }
    
    public static List<Member> getMemberInfo() {
        return memberInfo;
    }

    public static void setMemberInfo(List<Member> memberInfo) {
        Member.memberInfo = memberInfo;
    }

    public boolean signUp(ArrayList<String> info) {
        // 아이디가 중복일 경우 예외발생.
        try {
            memberList.put(info.get(0), info.get(1));
            Member member = new Member(info.get(0), info.get(1), info.get(2), info.get(3), info.get(4));        
            memberInfo.add(member);
            libraryOutputStreamImpl.writeMemberLoginInfo(memberList);
            libraryOutputStreamImpl.writeMember((ArrayList<Member>)memberInfo);
        } catch (Exception e) {
            return false;
        }
        
        return true;    
    }

    public boolean login(String id, String password) {
        memberList = libraryInputSteamImpl.readMemberLoginInfo();
        
        if(memberList.containsKey(id) && (memberList.get(id)).equals(password)) {
            
            libraryOutputStreamImpl.currentUser(new User(id, password));
            
            /*if(User.currentUser.containsKey(id)) {
                user = User.currentUser.get(id);
            } else {
                user = new User(id, password);
                User.currentUser.put(id, user);
            }*/

            return true;
        }
        return false;
    }
    
    
}
```

MemberServiceImpl

```java
package kr.ac.kopo.library;

import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.ArrayList;
import java.util.Calendar;
import java.util.Date;
import java.util.List;
import java.util.Map;
import java.util.Objects;
import java.util.Scanner;

import kr.ac.kopo.library.FileIO.LibraryInputSteamImpl;
import kr.ac.kopo.library.FileIO.LibraryOutputStreamImpl;

public class MemberServiceImpl {
    
    // FileIO 버전
    LibraryInputSteamImpl libraryInputSteamImpl = new LibraryInputSteamImpl();
    LibraryOutputStreamImpl libraryOutputStreamImpl = new LibraryOutputStreamImpl();
    ArrayList<Member> memberInfo;
    private User user;

    // 회원 목록 조회
    public void memberList() {  
        memberInfo = (ArrayList<Member>) libraryInputSteamImpl.readMember();
        for(Member m : memberInfo) {
            if(!(m == null)) {
                System.out.println(m.getId() + "\t" + m.getPassword() + "\t\t" + m.getName() + "\t" + m.getPhoneNumber()
                + "\t\t" + m.getAddress());
            }
            
        }   
    }
    
    // 회원 정보 조회
    public void viewMemberInfo() {
        memberInfo = (ArrayList<Member>) libraryInputSteamImpl.readMember();
        user = libraryInputSteamImpl.readUser();
        for(Member m : memberInfo) {
            if(m.getId().equals(user.getId())){             
                System.out.println(m.getId() + "\t" + m.getPassword() + "\t\t" + m.getName() + "\t" + m.getPhoneNumber()
                                        + "\t\t" + m.getAddress());
            }
        }
    }
    
    // 회원 정보 수정
    public void modifyMemberInfo(int choice, String data) { 
        memberInfo = (ArrayList<Member>) libraryInputSteamImpl.readMember();
        user = libraryInputSteamImpl.readUser();
        int cnt = 0;
        for(Member m : memberInfo) {
            if(m.getId().equals(user.getId())){     
                switch (choice) {
                case 1:
                    memberInfo.get(cnt).setPassword(data);
                    break;
                case 2:
                    memberInfo.get(cnt).setName(data);
                    break;
                case 3:
                    memberInfo.get(cnt).setPhoneNumber(data);
                case 4:
                    memberInfo.get(cnt).setAddress(data);
                }
            }
        }
        libraryOutputStreamImpl.writeMember((ArrayList<Member>)memberInfo);
            
    }

    
    
    //회원탈퇴
    public void removeMember() {
        memberInfo = (ArrayList<Member>) libraryInputSteamImpl.readMember();
        Map<String, String> memberList = libraryInputSteamImpl.readMemberLoginInfo();
        user = libraryInputSteamImpl.readUser();
        int cnt = 0;        
        for(Member m : memberInfo) {
            if(m.getId().equals(user.getId())){     
                memberInfo.remove(cnt);
                memberList.remove(m.getId());
                libraryOutputStreamImpl.writeMemberLoginInfo(memberList);
                libraryOutputStreamImpl.currentUser(null);
                libraryOutputStreamImpl.writeMember((ArrayList<Member>)memberInfo);
                return;
            }
            cnt++;
        }
        
    }
    
    // 대출 히스토리
    public void rentalHistory() {   
        Map<String, Book> bookRental = libraryInputSteamImpl.bookRental();
        Calendar cal = Calendar.getInstance();
        SimpleDateFormat format = new SimpleDateFormat("yyyy-MM-dd");
        Date date;
        
        for(Book b : bookRental.values()) {
            try {
                date = format.parse(b.getRentalDate());
                cal.setTime(date);
                cal.add(Calendar.DATE, 14);
                System.out.println(b.getIsbn() + "\t\t" + b.getBookName() + "\t" + b.getWriter() + "\t" + b.getPublisher()
                + "\t" + b.getGenre() + "\t" + b.getRentalDate() + "\t" + format.format(cal.getTime()));    
            } catch (ParseException e) {
                e.printStackTrace();
            }
            
        }

    }

}
```

Book

```java
package kr.ac.kopo.library;

import java.io.Serializable;
import java.util.ArrayList;
import java.util.List;
import java.util.Scanner;

public class Book {
    private String isbn;
    private String bookName;
    private String writer;
    private String publisher;
    private String genre;
    private String rental;
    private String rentalDate;  
    private static List<Book> bookInfo = new ArrayList<Book>();
    
    public Book() {        
    }
    public Book(String isbn, String bookName, String writer, String publisher, String genre) {
        this.isbn = isbn;
        this.bookName = bookName;
        this.writer = writer;
        this.publisher = publisher;
        this.genre = genre;
        this.rental = "대출 가능";
        this.rentalDate = null;
    }

    public String getIsbn() {
        return isbn;
    }

    public String getBookName() {
        return bookName;
    }

    public String getWriter() {
        return writer;
    }

    public String getPublisher() {
        return publisher;
    }

    public String getGenre() {
        return genre;
    }

    
    public String getRental() {
        return rental;
    }
    

    public void setRental(String rental) {
        this.rental = rental;
    }
    
    public String getRentalDate() {
        return rentalDate;
    }

    public void setRentalDate(String rentalDate) {
        this.rentalDate = rentalDate;
    }
    public static List<Book> getBookInfo() {
        return bookInfo;
    }
    public static void setBookInfo(List<Book> bookInfo) {
        Book.bookInfo = bookInfo;
    }
}
```

BookServiceImpl

```java
package kr.ac.kopo.library;

import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.Calendar;
import java.util.Date;
import java.util.HashMap;
import java.util.List;
import java.util.Map;
import java.util.Scanner;

import kr.ac.kopo.library.FileIO.LibraryInputSteamImpl;
import kr.ac.kopo.library.FileIO.LibraryOutputStreamImpl;

public class BookServiceImpl {
    
    private Scanner sc = new Scanner(System.in); 
    
    private LibraryOutputStreamImpl libraryOutputStreamImpl = new LibraryOutputStreamImpl();
    private LibraryInputSteamImpl libraryInputSteamImpl = new LibraryInputSteamImpl();
    private List<Book> bookInfo = libraryInputSteamImpl.readBook();
    private HashMap<String, Book> rentalBook = new HashMap();
    
    
    // 도서 등록

    public void addBook(int n) {    
        for(int i = 0; i < n; i++) {
            System.out.println("등록할 도서의 정보를 입력하세요. 도서번호(ISBN)는 중복을 허용하지 않습니다.");
            System.out.print("도서번호(ISBN) : ");
            String isbn = sc.nextLine();
            System.out.print("도서 제목 : ");
            String name = sc.nextLine();
            System.out.print("지은이 : ");
            String writer = sc.nextLine();
            System.out.print("출판사 : ");
            String publisher = sc.nextLine();
            System.out.print("장르 : ");
            String genre = sc.nextLine();
            
            System.out.println();
            Book book = new Book(isbn, name, writer, publisher, genre);
            bookInfo.add(book); 
            libraryOutputStreamImpl.writeBook((ArrayList<Book>) bookInfo);
        }
    
    }
    
    // 도서 목록 조회

    public void bookList() {
        bookInfo = libraryInputSteamImpl.readBook();
        for(Book b : bookInfo) {
            System.out.println(b.getIsbn() + "\t\t" + b.getBookName() + "\t" + b.getWriter() + "\t" + b.getPublisher()
                                + "\t" + b.getGenre() + "\t" + b.getRental());  
        }
        
    }
    
    // 도서 검색 

    public void bookSearch(int searchType, String keyword) {
        bookInfo = libraryInputSteamImpl.readBook();
        switch (searchType) {
        case 1: 
            for(Book b : bookInfo) {
                if(b.getBookName().equals(keyword)){ 
                    System.out.println(b.getIsbn() + "\t\t" + b.getBookName() + "\t" + b.getWriter() + "\t" + b.getPublisher()
                    + "\t" + b.getGenre() + "\t" + b.getRental());
                }
            }
            break;
        case 2:
            for(Book b : bookInfo) {
                if(b.getWriter().equals(keyword)){ 
                    System.out.println(b.getIsbn() + "\t\t" + b.getBookName() + "\t" + b.getWriter() + "\t" + b.getPublisher()
                    + "\t" + b.getGenre() + "\t" + b.getRental());
                }
            }
        case 3:
            for(Book b : bookInfo) {
                if(b.getPublisher().equals(keyword)){ 
                    System.out.println(b.getIsbn() + "\t\t" + b.getBookName() + "\t" + b.getWriter() + "\t" + b.getPublisher()
                    + "\t" + b.getGenre() + "\t" + b.getRental());
                }
            }
        case 4:
            for(Book b : bookInfo) {
                if(b.getGenre().equals(keyword)){ 
                    System.out.println(b.getIsbn() + "\t\t" + b.getBookName() + "\t" + b.getWriter() + "\t" + b.getPublisher()
                    + "\t" + b.getGenre() + "\t" + b.getRental());
                }
            }
        }
    
    }
    
    // 도서 삭제
    public void removeBook(String isbn) {
        bookInfo = libraryInputSteamImpl.readBook();
        int cnt = 0;
        for(Book b : bookInfo) {
            if(b.getIsbn().equals(isbn)){ 
                bookInfo.remove(cnt);
                libraryOutputStreamImpl.writeBook((ArrayList<Book>) bookInfo);
                return;
            }
            cnt++;
        }      
    }
    
    // 도서 대출
    public void bookRental(String isbn) {
        bookInfo = libraryInputSteamImpl.readBook();    
        int cnt = 0;
        for(Book b : bookInfo) {
            if(b.getIsbn().equals(isbn)) {
                bookInfo.get(cnt).setRental("대출 중");;
                
                SimpleDateFormat format = new SimpleDateFormat("yyyy-MM-dd");
                bookInfo.get(cnt).setRentalDate( format.format(new Date()));
                rentalBook.put(isbn, b);
                libraryOutputStreamImpl.writeRentalHistory(rentalBook);
            }
            cnt++;
        }
        libraryOutputStreamImpl.writeBook((ArrayList<Book>) bookInfo);
    }

    // 도서 대출 연장
    public void bookRentalExtend(String isbn) {     
        rentalBook = libraryInputSteamImpl.bookRental();
        Calendar cal = Calendar.getInstance();
        SimpleDateFormat format = new SimpleDateFormat("yyyy-MM-dd");
        Date date;
        
        for(Book b : rentalBook.values()) {
            if(b.getIsbn().equals(isbn)) {
                try {
                    date = format.parse(b.getRentalDate());
                    cal.setTime(date);
                    cal.add(Calendar.DATE, 14);
                    rentalBook.get(isbn).setRentalDate(format.format(cal.getTime()));
                    libraryOutputStreamImpl.writeRentalHistory(rentalBook);
                } catch (ParseException e) {
                    e.printStackTrace();
                }
            }

            
        }
    }
    
    // 도서 반납
    public void bookReturn(String isbn) {
        bookInfo = libraryInputSteamImpl.readBook();
        rentalBook = libraryInputSteamImpl.bookRental();
        int cnt =0;
        for(Book b : bookInfo) {
            if(b.getIsbn().equals(isbn)) {
                bookInfo.get(cnt).setRental("대출 가능");
                rentalBook.remove(isbn);
                libraryOutputStreamImpl.writeRentalHistory(rentalBook);     
                libraryOutputStreamImpl.writeBook((ArrayList<Book>) bookInfo);
            }
            cnt++;
        }
    }

}
```

—>파일 입출력에 뭔가 빠져 다시 또 잘못된 설계를 하게 되었다 → 또 파일 입출력이 잘못됨

—>그래도 최대한 기능부터 설계하려고 노력하였다

—>아직 클래스끼리 연결하지 않고 메소드만 최대한 구현한 상태(상위 인터페이스에 추가할 예정)

—>test 예정, 껍데기 만들 예정 인터페이스를 활용해서 최대한 확장에 열여있는 설계를 할 예정

## 느낀점

- 설계가 정말 중요하다.
- 데이터베이스와 껍데기는 마지막 부분에..