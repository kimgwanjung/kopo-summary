# 1일차(PL/SQL, 연산식, 조건문, 반목문)

### PL/SQL = SQL + PL(Procedural Language)

SQL(비절차적) 기능에 PL(절차적) 기능을 추가한 언어

## 비절차적 언어란?

<aside>
👉🏻 **ex) `SELECT * FROM EMP WHERE SAL > 2000;`**

</aside>

- What을 정의하고 DBMS 서버에 던지는 것
- C, Java, Python

### 절차적 언어란?

![Untitled](1%E1%84%8B%E1%85%B5%E1%86%AF%E1%84%8E%E1%85%A1(PL%20SQL,%20%E1%84%8B%E1%85%A7%E1%86%AB%E1%84%89%E1%85%A1%E1%86%AB%E1%84%89%E1%85%B5%E1%86%A8,%20%E1%84%8C%E1%85%A9%E1%84%80%E1%85%A5%E1%86%AB%E1%84%86%E1%85%AE%E1%86%AB,%20%E1%84%87%E1%85%A1%E1%86%AB%E1%84%86%E1%85%A9%E1%86%A8%E1%84%86%E1%85%AE%E1%86%AB)%20aeb21a1827614444919de2b896cc5597/Untitled.png)

- Exception : Runtime ERROR
- 모듈화 : CLASS, FUNCTION 등 → 재사용(생산성 향상)

![Untitled](1%E1%84%8B%E1%85%B5%E1%86%AF%E1%84%8E%E1%85%A1(PL%20SQL,%20%E1%84%8B%E1%85%A7%E1%86%AB%E1%84%89%E1%85%A1%E1%86%AB%E1%84%89%E1%85%B5%E1%86%A8,%20%E1%84%8C%E1%85%A9%E1%84%80%E1%85%A5%E1%86%AB%E1%84%86%E1%85%AE%E1%86%AB,%20%E1%84%87%E1%85%A1%E1%86%AB%E1%84%86%E1%85%A9%E1%86%A8%E1%84%86%E1%85%AE%E1%86%AB)%20aeb21a1827614444919de2b896cc5597/Untitled%201.png)

### 여기서  DBMS는?

<aside>
👉🏻 **처리 방법, 처리 순서 즉, How를 정의한다.**

</aside>

### 기본 PL/SQL 구조

![Untitled](1%E1%84%8B%E1%85%B5%E1%86%AF%E1%84%8E%E1%85%A1(PL%20SQL,%20%E1%84%8B%E1%85%A7%E1%86%AB%E1%84%89%E1%85%A1%E1%86%AB%E1%84%89%E1%85%B5%E1%86%A8,%20%E1%84%8C%E1%85%A9%E1%84%80%E1%85%A5%E1%86%AB%E1%84%86%E1%85%AE%E1%86%AB,%20%E1%84%87%E1%85%A1%E1%86%AB%E1%84%86%E1%85%A9%E1%86%A8%E1%84%86%E1%85%AE%E1%86%AB)%20aeb21a1827614444919de2b896cc5597/Untitled%202.png)

### PL/SQL 주요 특징

**1) 블록 구조**

- PL/SQL is a block-structured language
- BLOCK은 ① 선언부 ② 실행부 ③ 예외처리부 로 구성

![Untitled](1%E1%84%8B%E1%85%B5%E1%86%AF%E1%84%8E%E1%85%A1(PL%20SQL,%20%E1%84%8B%E1%85%A7%E1%86%AB%E1%84%89%E1%85%A1%E1%86%AB%E1%84%89%E1%85%B5%E1%86%A8,%20%E1%84%8C%E1%85%A9%E1%84%80%E1%85%A5%E1%86%AB%E1%84%86%E1%85%AE%E1%86%AB,%20%E1%84%87%E1%85%A1%E1%86%AB%E1%84%86%E1%85%A9%E1%86%A8%E1%84%86%E1%85%AE%E1%86%AB)%20aeb21a1827614444919de2b896cc5597/Untitled%203.png)

![Untitled](1%E1%84%8B%E1%85%B5%E1%86%AF%E1%84%8E%E1%85%A1(PL%20SQL,%20%E1%84%8B%E1%85%A7%E1%86%AB%E1%84%89%E1%85%A1%E1%86%AB%E1%84%89%E1%85%B5%E1%86%A8,%20%E1%84%8C%E1%85%A9%E1%84%80%E1%85%A5%E1%86%AB%E1%84%86%E1%85%AE%E1%86%AB,%20%E1%84%87%E1%85%A1%E1%86%AB%E1%84%86%E1%85%A9%E1%86%A8%E1%84%86%E1%85%AE%E1%86%AB)%20aeb21a1827614444919de2b896cc5597/Untitled%204.png)

실행부와 예외처리부를 분리 → 코드가 간결해짐

**EX)**

![Untitled](1%E1%84%8B%E1%85%B5%E1%86%AF%E1%84%8E%E1%85%A1(PL%20SQL,%20%E1%84%8B%E1%85%A7%E1%86%AB%E1%84%89%E1%85%A1%E1%86%AB%E1%84%89%E1%85%B5%E1%86%A8,%20%E1%84%8C%E1%85%A9%E1%84%80%E1%85%A5%E1%86%AB%E1%84%86%E1%85%AE%E1%86%AB,%20%E1%84%87%E1%85%A1%E1%86%AB%E1%84%86%E1%85%A9%E1%86%A8%E1%84%86%E1%85%AE%E1%86%AB)%20aeb21a1827614444919de2b896cc5597/Untitled%205.png)

**2) 변수 선언**

![Untitled](1%E1%84%8B%E1%85%B5%E1%86%AF%E1%84%8E%E1%85%A1(PL%20SQL,%20%E1%84%8B%E1%85%A7%E1%86%AB%E1%84%89%E1%85%A1%E1%86%AB%E1%84%89%E1%85%B5%E1%86%A8,%20%E1%84%8C%E1%85%A9%E1%84%80%E1%85%A5%E1%86%AB%E1%84%86%E1%85%AE%E1%86%AB,%20%E1%84%87%E1%85%A1%E1%86%AB%E1%84%86%E1%85%A9%E1%86%A8%E1%84%86%E1%85%AE%E1%86%AB)%20aeb21a1827614444919de2b896cc5597/Untitled%206.png)

![Untitled](1%E1%84%8B%E1%85%B5%E1%86%AF%E1%84%8E%E1%85%A1(PL%20SQL,%20%E1%84%8B%E1%85%A7%E1%86%AB%E1%84%89%E1%85%A1%E1%86%AB%E1%84%89%E1%85%B5%E1%86%A8,%20%E1%84%8C%E1%85%A9%E1%84%80%E1%85%A5%E1%86%AB%E1%84%86%E1%85%AE%E1%86%AB,%20%E1%84%87%E1%85%A1%E1%86%AB%E1%84%86%E1%85%A9%E1%86%A8%E1%84%86%E1%85%AE%E1%86%AB)%20aeb21a1827614444919de2b896cc5597/Untitled%207.png)

# ****커서(Cursor)

뒤에서 다룸 중요**

**3) 제어 구조**

- 프로그램의 처리(실행) 흐름 제어하는 조건문/반복문/GOTO문

![Untitled](1%E1%84%8B%E1%85%B5%E1%86%AF%E1%84%8E%E1%85%A1(PL%20SQL,%20%E1%84%8B%E1%85%A7%E1%86%AB%E1%84%89%E1%85%A1%E1%86%AB%E1%84%89%E1%85%B5%E1%86%A8,%20%E1%84%8C%E1%85%A9%E1%84%80%E1%85%A5%E1%86%AB%E1%84%86%E1%85%AE%E1%86%AB,%20%E1%84%87%E1%85%A1%E1%86%AB%E1%84%86%E1%85%A9%E1%86%A8%E1%84%86%E1%85%AE%E1%86%AB)%20aeb21a1827614444919de2b896cc5597/Untitled%208.png)

ELSE IF가 아닌 ESLIF로 사용

- WHILE LOOP 가능

**4) 예외처리** 

- JAVA or C++ 같은 최신언어 (?) 처럼 예외처리 기능 지원
- 예외처리 목적 :

![Untitled](1%E1%84%8B%E1%85%B5%E1%86%AF%E1%84%8E%E1%85%A1(PL%20SQL,%20%E1%84%8B%E1%85%A7%E1%86%AB%E1%84%89%E1%85%A1%E1%86%AB%E1%84%89%E1%85%B5%E1%86%A8,%20%E1%84%8C%E1%85%A9%E1%84%80%E1%85%A5%E1%86%AB%E1%84%86%E1%85%AE%E1%86%AB,%20%E1%84%87%E1%85%A1%E1%86%AB%E1%84%86%E1%85%A9%E1%86%A8%E1%84%86%E1%85%AE%E1%86%AB)%20aeb21a1827614444919de2b896cc5597/Untitled%209.png)

**5) 모듈화**

- 모듈단위로 개발하여 라이브러리화 시켜 재사용 목적

![Untitled](1%E1%84%8B%E1%85%B5%E1%86%AF%E1%84%8E%E1%85%A1(PL%20SQL,%20%E1%84%8B%E1%85%A7%E1%86%AB%E1%84%89%E1%85%A1%E1%86%AB%E1%84%89%E1%85%B5%E1%86%A8,%20%E1%84%8C%E1%85%A9%E1%84%80%E1%85%A5%E1%86%AB%E1%84%86%E1%85%AE%E1%86%AB,%20%E1%84%87%E1%85%A1%E1%86%AB%E1%84%86%E1%85%A9%E1%86%A8%E1%84%86%E1%85%AE%E1%86%AB)%20aeb21a1827614444919de2b896cc5597/Untitled%2010.png)

- **Anonymous Block:** 이름이 없는 블록을 의미 하며, 실행하기 위해 프로그램 안에서 선언 되고 실행시에 실행을 위해 PL/SQL 엔진으로 전달 된다. 선행 컴파일러 프로그램과 SQL*Plus 또는 서버 관리자에서 익명의 블록을 내장 할 수 있다.
- **Named Block :** 일련의 코드를 그룹화하고 이름을 지정하여 관련 코드의 실행을 제어하는 기능을 나타냅니다. 이는 코드의 가독성을 높이고, 코드의 재사용성을 높이며, 코드를 구조화하는 데 도움을 줍니다**.**
- **Stored Block** : 데이터베이스 내에 저장된 프로시저, 함수, 트리거 등과 같은 데이터베이스 객체를 가리킵니다. 이러한 객체는 데이터베이스 내에서 별도의 블록으로 저장되며, 일련의 코드로 구성되어 특정 작업을 수행하거나 특정 이벤트에 반응

Named Block = Stored Block

# PL/SQL 장점

## **이식성**

## **통합성**

## **성능**

![Untitled](1%E1%84%8B%E1%85%B5%E1%86%AF%E1%84%8E%E1%85%A1(PL%20SQL,%20%E1%84%8B%E1%85%A7%E1%86%AB%E1%84%89%E1%85%A1%E1%86%AB%E1%84%89%E1%85%B5%E1%86%A8,%20%E1%84%8C%E1%85%A9%E1%84%80%E1%85%A5%E1%86%AB%E1%84%86%E1%85%AE%E1%86%AB,%20%E1%84%87%E1%85%A1%E1%86%AB%E1%84%86%E1%85%A9%E1%86%A8%E1%84%86%E1%85%AE%E1%86%AB)%20aeb21a1827614444919de2b896cc5597/Untitled%2011.png)

**여러 번 주고 받아야 하는 것을 묶어서 하나의 덩어리(BLOCK) 처리하면 네트웍 트래픽을 줄이는 효과는 나타나지만 PL/SQL의 성능 향상은 데이터 와 데이터 처리 로직이 DBMS 서버내에 통합되어 처리되는 통합성에 의한 것.**

# 실행구조 및 PL/SQL 엔진

## 실행구조

![Untitled](1%E1%84%8B%E1%85%B5%E1%86%AF%E1%84%8E%E1%85%A1(PL%20SQL,%20%E1%84%8B%E1%85%A7%E1%86%AB%E1%84%89%E1%85%A1%E1%86%AB%E1%84%89%E1%85%B5%E1%86%A8,%20%E1%84%8C%E1%85%A9%E1%84%80%E1%85%A5%E1%86%AB%E1%84%86%E1%85%AE%E1%86%AB,%20%E1%84%87%E1%85%A1%E1%86%AB%E1%84%86%E1%85%A9%E1%86%A8%E1%84%86%E1%85%AE%E1%86%AB)%20aeb21a1827614444919de2b896cc5597/Untitled%2012.png)

**Anonymous Block** : **Client**에 저장

**Named Block** : **Server**에 저장

![Untitled](1%E1%84%8B%E1%85%B5%E1%86%AF%E1%84%8E%E1%85%A1(PL%20SQL,%20%E1%84%8B%E1%85%A7%E1%86%AB%E1%84%89%E1%85%A1%E1%86%AB%E1%84%89%E1%85%B5%E1%86%A8,%20%E1%84%8C%E1%85%A9%E1%84%80%E1%85%A5%E1%86%AB%E1%84%86%E1%85%AE%E1%86%AB,%20%E1%84%87%E1%85%A1%E1%86%AB%E1%84%86%E1%85%A9%E1%86%A8%E1%84%86%E1%85%AE%E1%86%AB)%20aeb21a1827614444919de2b896cc5597/Untitled%2013.png)

## PL/SQL 엔진

![Untitled](1%E1%84%8B%E1%85%B5%E1%86%AF%E1%84%8E%E1%85%A1(PL%20SQL,%20%E1%84%8B%E1%85%A7%E1%86%AB%E1%84%89%E1%85%A1%E1%86%AB%E1%84%89%E1%85%B5%E1%86%A8,%20%E1%84%8C%E1%85%A9%E1%84%80%E1%85%A5%E1%86%AB%E1%84%86%E1%85%AE%E1%86%AB,%20%E1%84%87%E1%85%A1%E1%86%AB%E1%84%86%E1%85%A9%E1%86%A8%E1%84%86%E1%85%AE%E1%86%AB)%20aeb21a1827614444919de2b896cc5597/Untitled%2014.png)

**PL/SQL 엔진에서는 PL/SQL Block을 분석하여**

- PL/SQL 기능은 절차적 처리기 (Procedural Statement Executor)에게 보내어 실행
- SQL 기능은 SQL 처리기(SQL Statement Executor)에게 보내어 실행

## 개발 Tool

![Untitled](1%E1%84%8B%E1%85%B5%E1%86%AF%E1%84%8E%E1%85%A1(PL%20SQL,%20%E1%84%8B%E1%85%A7%E1%86%AB%E1%84%89%E1%85%A1%E1%86%AB%E1%84%89%E1%85%B5%E1%86%A8,%20%E1%84%8C%E1%85%A9%E1%84%80%E1%85%A5%E1%86%AB%E1%84%86%E1%85%AE%E1%86%AB,%20%E1%84%87%E1%85%A1%E1%86%AB%E1%84%86%E1%85%A9%E1%86%A8%E1%84%86%E1%85%AE%E1%86%AB)%20aeb21a1827614444919de2b896cc5597/Untitled%2015.png)

![Untitled](1%E1%84%8B%E1%85%B5%E1%86%AF%E1%84%8E%E1%85%A1(PL%20SQL,%20%E1%84%8B%E1%85%A7%E1%86%AB%E1%84%89%E1%85%A1%E1%86%AB%E1%84%89%E1%85%B5%E1%86%A8,%20%E1%84%8C%E1%85%A9%E1%84%80%E1%85%A5%E1%86%AB%E1%84%86%E1%85%AE%E1%86%AB,%20%E1%84%87%E1%85%A1%E1%86%AB%E1%84%86%E1%85%A9%E1%86%A8%E1%84%86%E1%85%AE%E1%86%AB)%20aeb21a1827614444919de2b896cc5597/Untitled%2016.png)

**REM DEFAULT SIZE 1M bytes :** REM은 주석을 나타내는

**SET SERVEROUTPUT ON  2000~1000000:** 출력 결과 보여주는, SIZE를 지정하여 그 크기 만큼만 출력 가

**BEGIN  ~END;/** : 시작과 끝

# PL/SQL 기본문법

## 변수

![Untitled](1%E1%84%8B%E1%85%B5%E1%86%AF%E1%84%8E%E1%85%A1(PL%20SQL,%20%E1%84%8B%E1%85%A7%E1%86%AB%E1%84%89%E1%85%A1%E1%86%AB%E1%84%89%E1%85%B5%E1%86%A8,%20%E1%84%8C%E1%85%A9%E1%84%80%E1%85%A5%E1%86%AB%E1%84%86%E1%85%AE%E1%86%AB,%20%E1%84%87%E1%85%A1%E1%86%AB%E1%84%86%E1%85%A9%E1%86%A8%E1%84%86%E1%85%AE%E1%86%AB)%20aeb21a1827614444919de2b896cc5597/Untitled%2017.png)

<aside>
👉🏻 `:=` 는 **대입연산자**

`=` 은 **비교연산자**

</aside>

## 연산자

![Untitled](1%E1%84%8B%E1%85%B5%E1%86%AF%E1%84%8E%E1%85%A1(PL%20SQL,%20%E1%84%8B%E1%85%A7%E1%86%AB%E1%84%89%E1%85%A1%E1%86%AB%E1%84%89%E1%85%B5%E1%86%A8,%20%E1%84%8C%E1%85%A9%E1%84%80%E1%85%A5%E1%86%AB%E1%84%86%E1%85%AE%E1%86%AB,%20%E1%84%87%E1%85%A1%E1%86%AB%E1%84%86%E1%85%A9%E1%86%A8%E1%84%86%E1%85%AE%E1%86%AB)%20aeb21a1827614444919de2b896cc5597/Untitled%2018.png)

![Untitled](1%E1%84%8B%E1%85%B5%E1%86%AF%E1%84%8E%E1%85%A1(PL%20SQL,%20%E1%84%8B%E1%85%A7%E1%86%AB%E1%84%89%E1%85%A1%E1%86%AB%E1%84%89%E1%85%B5%E1%86%A8,%20%E1%84%8C%E1%85%A9%E1%84%80%E1%85%A5%E1%86%AB%E1%84%86%E1%85%AE%E1%86%AB,%20%E1%84%87%E1%85%A1%E1%86%AB%E1%84%86%E1%85%A9%E1%86%A8%E1%84%86%E1%85%AE%E1%86%AB)%20aeb21a1827614444919de2b896cc5597/Untitled%2019.png)

<aside>
👉🏻 `BOOLEAN 에 TRUE, FALSE, NULL이 있다.`

</aside>

```sql
DECLARE
        V_XX        NUMBER(4):=10;
        V_YY        BOOLEAN;
        V_TAX_RATE  CONSTANT NUMBER(5,3):=0.054;
        V_SAL       NUMBER(4):=9999;
BEGIN
 IF V_YY IS NULL THEN
            DBMS_OUTPUT.PUT_LINE('SQL operator');
    END IF;
    V_YY:=((V_XX - 1) ** 3>500) AND (V_SAL > 7000);
    DBMS_OUTPUT.PUT_LINE(case when V_YY then 'TRUE' else 'FALSE' end);
    
    IF(V_SAL * V_TAX_RATE) BETWEEN 500 AND 1000 THEN
            DBMS_OUTPUT.PUT_LINE('High pay');
    END IF;
END;
/
```

## 조건식

```sql
DECLARE
		V_EMPNO NUMBER(4) := 8888; -- 변수선언 및 초기화
		V_DEPTNO NUMBER(2);
		V_ENAME VARCHAR2(10) := 'XMAN';
		V_JOB VARCHAR2(9);
		V_SAL NUMBER(7,2);
BEGIN
		V_DEPTNO := 20;  -- 변수에 값 대입
		IF V_JOB IS NULL THEN
				V_JOB := '신입';
		END IF;
		IF V_JOB = '신입' THEN -- TRUE, FALSE, NULL
						V_SAL := 2000;
		ELSIF V_JOB IN ('MANAGER','ANALYST') THEN -- ELSEIF(X)
				V_SAL := 3500;
		ELSE
				V_SAL := 2500;
		END IF;
		INSERT INTO EMP(DEPTNO,EMPNO,ENAME,SAL,JOB)
				VALUES(V_DEPTNO,V_EMPNO,V_ENAME,V_SAL,V_JOB);
		COMMIT;
END;
/

SELECT * FROM EMP WHERE EMPNO = 8888;
```

## 반복문

![Untitled](1%E1%84%8B%E1%85%B5%E1%86%AF%E1%84%8E%E1%85%A1(PL%20SQL,%20%E1%84%8B%E1%85%A7%E1%86%AB%E1%84%89%E1%85%A1%E1%86%AB%E1%84%89%E1%85%B5%E1%86%A8,%20%E1%84%8C%E1%85%A9%E1%84%80%E1%85%A5%E1%86%AB%E1%84%86%E1%85%AE%E1%86%AB,%20%E1%84%87%E1%85%A1%E1%86%AB%E1%84%86%E1%85%A9%E1%86%A8%E1%84%86%E1%85%AE%E1%86%AB)%20aeb21a1827614444919de2b896cc5597/Untitled%2020.png)

<aside>
👉🏻  LOOP로 시작하고 END LOOP로 종료 , END LOOP 다음에 세미콜론(;)을 문장 종결자로 사용
PL/SQL 문법은 다양한 변형이 가능한 C 언어 문법과 달리 문법 자체가 규칙적으로 정형화
예) IF ~ END IF;
LOOP ~ END LOOP;

</aside>

![Untitled](1%E1%84%8B%E1%85%B5%E1%86%AF%E1%84%8E%E1%85%A1(PL%20SQL,%20%E1%84%8B%E1%85%A7%E1%86%AB%E1%84%89%E1%85%A1%E1%86%AB%E1%84%89%E1%85%B5%E1%86%A8,%20%E1%84%8C%E1%85%A9%E1%84%80%E1%85%A5%E1%86%AB%E1%84%86%E1%85%AE%E1%86%AB,%20%E1%84%87%E1%85%A1%E1%86%AB%E1%84%86%E1%85%A9%E1%86%A8%E1%84%86%E1%85%AE%E1%86%AB)%20aeb21a1827614444919de2b896cc5597/Untitled%2021.png)

<aside>
👉🏻 loop_index의 특징

- block내에서 정수 데이터 타입(INTEGER TYPE)으로 암시적, 자동으로(implicit)으로 선언
- 증가,감소 폭은 1 , 증가폭 변경 불가 (참조만 가능)
ex) V_tmp := loop_index; (O)
loop_index := loop_index + 1; (X)
- lower_bound .. upper_bound : loop_index 가 실행되는 시작(하한값) 및 종료(상한값) 범위
lower_bound ~ 하한값(시작)
upper_bound ~ 상한값(종료)
</aside>

## While LOOP

![Untitled](1%E1%84%8B%E1%85%B5%E1%86%AF%E1%84%8E%E1%85%A1(PL%20SQL,%20%E1%84%8B%E1%85%A7%E1%86%AB%E1%84%89%E1%85%A1%E1%86%AB%E1%84%89%E1%85%B5%E1%86%A8,%20%E1%84%8C%E1%85%A9%E1%84%80%E1%85%A5%E1%86%AB%E1%84%86%E1%85%AE%E1%86%AB,%20%E1%84%87%E1%85%A1%E1%86%AB%E1%84%86%E1%85%A9%E1%86%A8%E1%84%86%E1%85%AE%E1%86%AB)%20aeb21a1827614444919de2b896cc5597/Untitled%2022.png)